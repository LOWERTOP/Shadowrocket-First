#!name=Wi-Fi Calling UK
#!desc=è‹±å›½ SIM å¡ Wi-Fi Calling é…ç½®æ¨¡å—ï¼ˆæµ‹è¯•ç‰ˆï¼‰
#!arguments=åœ°åŒºå®šä½:true
#!arguments-desc=\næ›´æ”¹åŸºäºç½‘ç»œçš„åœ°åŒºæ£€æµ‹ç»“æœè‡³æŒ‡å®šåœ°åŒºã€‚ä½†å½“å­˜åœ¨ç§»åŠ¨èœ‚çªç½‘ç»œæ—¶ä¸è§¦å‘æ­¤æ£€æµ‹æ–¹å¼ï¼Œä¿®æ”¹ç½‘ç»œå®šä½é¡»å¼€å¯é£è¡Œæ¨¡å¼æ‰å¯ç”Ÿæ•ˆ\n\nç¡®è®¤æ­¥éª¤å¦‚ä¸‹ï¼š\n\n Â· è®¿é—®ï¼šhttps://gspe1-ssl.ls.apple.com/pep/gcc\n\n Â· é¡µé¢ä¸Šæ˜¾ç¤ºçš„ä¸¤ä¸ªå­—æ¯å³ä¸ºå½“å‰ç”Ÿæ•ˆçš„åœ°åŒºä»£ç 
# æœ¬è§„åˆ™ä»…é€‚ç”¨äºéƒ¨åˆ†è‹±å›½ SIM å¡çš„ Wi-Fi Calling åŠŸèƒ½ã€‚
# è§„åˆ™æ¥æºï¼šhttps://github.com/iniwex5
# ç‰¹åˆ«é¸£è°¢ï¼šhttps://github.com/XiangwanGuan
# ä»“åº“åœ°å€ï¼šhttps://github.com/LOWERTOP/Shadowrocket-First

[Proxy Group]
WiFiCall = url-test,url=http://www.gstatic.com/generate_204,interval=600,tolerance=0,timeout=5,select=0,policy-regex-filter=ğŸ‡¬ğŸ‡§|UK|GB|Kingdom|England|uk|Britain|British|London|è‹±å›½|ä¼¦æ•¦|è‹±

[Script]
åœ°åŒºå®šä½æ§åˆ¶ = type=http-request, enable={{{åœ°åŒºå®šä½}}}, pattern=^https?:\/\/gspe1-ssl\.ls\.apple\.com, script-path=https://raw.githubusercontent.com/LOWERTOP/Shadowrocket-First/refs/heads/main/JS/WiFiCall_switch.js, requires-body=0, max-size=0, timeout=10

[Rule]
# åœ°åŒºæ£€æµ‹
# DOMAIN-SUFFIX,gspe1-ssl.ls.apple.com,WiFiCall

# ç«¯å£åˆ†æµ
AND,((GEOIP,GB),(AND,((PROTOCOL,UDP),(OR,((DEST-PORT,500),(DEST-PORT,4500)))))), WiFiCall

# æ²ƒè¾¾ä¸°
DOMAIN-SUFFIX,entsrv-uk.vodafone.com,WiFiCall
DOMAIN-SUFFIX,epdg.epc.mnc015.mcc234.pub.3gppnetwork.org,WiFiCall
DOMAIN-SUFFIX,ss.epdg.epc.mnc015.mcc234.pub.3gppnetwork.org,WiFiCall
DOMAIN-SUFFIX,ss.epdg.epc.geo.mnc015.mcc234.pub.3gppnetwork.org,WiFiCall
DOMAIN-SUFFIX,vuk-gto.prod.ondemandconnectivity.com,WiFiCall
IP-CIDR,88.82.0.0/19,WiFiCall,no-resolve

# CMLink UK EE
IP-CIDR,46.68.0.0/17,WiFiCall,no-resolve

# Giffgaff
DOMAIN-SUFFIX,giffgaff.com,WiFiCall
IP-CIDR,87.194.0.0/16,WiFiCall,no-resolve
